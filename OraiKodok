--normalizálás
--szerk. bőv, Patika fh. funkcióra

create database patika

use patika

create table Orvos
(
kód int,
nev varchar(30) not null,
szak char(40) not null,
primary key(kód)
)

insert into Orvos values(12345, 'dr Méz', 'gyerekorvos')
select * from Orvos

insert into Orvos values(54321, 'dr Méz', 'gyerekorvos')
insert into Orvos values(55555, 'dr Ő', 'szülész-nőgyógyász')


--fa: a SZK legyen szótárazott... az adatok el ne vesszenek!


create table Szak
(
szak int identity(11,1), --autoincrement
megnevezes char(40),
primary key (szak) 
)


insert into Szak
select distinct Szak
from Orvos


create unique index neves1 on Szak (megnevezes)
insert into Szak values ('onkologus')

select * from Szak
select * from Orvos

alter table Orvos
add szaKK int

select *
from Orvos
	inner join szak on orvos.szak = szak.megnevezes

update Orvos
set szakk = (select szak from szak where szak.megnevezes = Orvos.szak)


alter table Orvos
drop column szak


alter table Orvos
add foreign key (szakk) references szak (szak)
